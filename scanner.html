<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' https://cdn.jsdelivr.net; frame-src 'self'; object-src 'none';">
    <meta http-equiv="Permissions-Policy" content="camera=(self 'https://derekf138.github.io'); fullscreen=(self)">
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode/minified/html5-qrcode.min.js"></script>
</head>
<body>
    <div id="reader" style="width:600px;height:300px;"></div>
    <button id="request-permission">Request Camera Permission</button>
    <script>
        function onScanSuccess(qrCodeMessage) {
            alert(`QR Code detected: ${qrCodeMessage}`);
        }

        function onScanError(errorMessage) {
            console.error(errorMessage);
        }

        document.getElementById('request-permission').addEventListener('click', () => {
            navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => {
                document.getElementById('request-permission').style.display = 'none';
                var html5QrcodeScanner = new Html5QrcodeScanner(
                    "reader", { fps: 10, qrbox: 250 });
                html5QrcodeScanner.render(onScanSuccess, onScanError);
            })
            .catch(error => {
                console.error('Permission denied:', error);
            });
        });
    </script>
</body>
</html>
